Vue.config.devtools=!0,Vue.component("the-loop",{template:"#the-loop",props:["posts","pagers"]}),Vue.component("sidebar",{template:"#sidebar"}),Vue.component("footer-component",{template:"#footer"}),Vue.component("nopost",{template:"#nopost"}),Vue.component("header-component",{template:"#header",data:function(){return{pages:[]}},mounted:function(){var _this=this;axios.get("/wp-json/wp/v2/pages?per_page=5").then(function(response){_this.pages=response.data}).catch(function(error){console.log(error)})}}),Vue.component("search-form",{template:"#search-form",methods:{doSearch:function(){this.$router.push({name:"search",query:{term:this.searchTerm}})}},data:function(){return{searchTerm:this.$route.query.term?this.$route.query.term:""}},watch:{$route:function(to,from){var searchTerm=to.query.term?to.query.term:"";this.searchTerm=searchTerm}}}),Vue.component("comment-form",{template:"#comment-form",methods:{validEmail:function(email){return/\S+@\S+/.test(email.toLowerCase())},validate:function(){this.commenterBlured=!0,this.emailBlured=!0,this.contentBlured=!0,""!==this.commenter&&this.validEmail(this.email)&&""!==this.content&&(this.valid=!0)},submit:function(){var _this=this;_this.validate(),_this.valid&&axios.post("/wp-json/wp/v2/comments",{author_name:_this.commenter,author_email:_this.email,content:_this.content,author_url:_this.website,post:_this.$parent.post[0].id}).then(function(response){_this.submitted=!0}).catch(function(error){console.log(error)})}},data:function(){return{commenter:"",commenterBlured:!1,email:"",emailBlured:!1,website:"",content:"",contentBlured:!1,valid:!1,submitted:!1}}}),Vue.component("comments",{template:"#comments",props:["comments"]});const PageNotFound=Vue.component("pagenotfound",{template:"#pagenotfound"}),Home=Vue.component("home",{template:"#home",props:["posts","pagers"]}),Single=Vue.component("single",{template:"#single",props:["post","comments"]}),Page=Vue.component("page",{template:"#page",props:["post"]}),Archive=Vue.component("archive",{template:"#archive",props:["posts","pagers"]}),Search=Vue.component("search",{template:"#search",props:["posts","pagers"]}),routes=[{path:"/",component:Home},{path:"/post/:slug",component:Single,name:"post"},{path:"/preview/:id",component:Single,name:"preview"},{path:"/page/:slug",component:Page,name:"page"},{path:"/category/:category",name:"category",component:Archive},{path:"/tag/:tag",name:"tag",component:Archive},{path:"/blog/",name:"blog",component:Archive},{path:"/search/",name:"search",component:Search},{path:"*",component:PageNotFound}],router=new VueRouter({routes:routes,mode:"history"}),app=new Vue({router:router,data:{bloginfo:{name:"",url:"",description:""},posts:[],comments:[],post:{},pagers:[]},created:function(){this.getBloginfo(),this.updateData()},watch:{$route:function(to,from){this.updateData()}},methods:{getBloginfo:function(){var _this=this;axios.get("/wp-json/").then(function(response){_this.bloginfo.name=response.data.name,_this.bloginfo.description=response.data.description,_this.bloginfo.url=response.data.url}).catch(function(error){console.log(error)})},buildPager:function(headers){headers["x-wp-total"];for(var pages=headers["x-wp-totalpages"],pagers=[],i=0;i<pages;i++)pagers.push(i+1);return pagers},updateData:function(){"post"==this.$route.name||"page"==this.$route.name||"preview"==this.$route.name?(this.posts=[],this.pagers=[],this.fetchSinglePost()):this.fetchPosts()},fetchComments:function(){var _this=this;axios.get("/wp-json/wp/v2/comments?post="+this.post[0].id).then(function(response){_this.comments=response.data}).catch(function(error){console.log(error)})},fetchSinglePost:function(){var _this=this,ajax={},type=_this.$route.name;switch(type){case"post":ajax=axios.get("/wp-json/wp/v2/posts?slug="+_this.$route.params.slug);break;case"page":ajax=axios.get("/wp-json/wp/v2/pages?slug="+_this.$route.params.slug);break;case"preview":ajax=axios.get("/wp-json/wpvue/preview?id="+_this.$route.params.id)}ajax.then(function(response){_this.post=response.data,"page"!=type&&_this.post.length>0&&_this.fetchComments()}).catch(function(error){console.log(error)})},fetchPosts:function(){var _this=this,urlStr="/wp-json/wp/v2/posts?";_this.isEmpty(_this.$route.params)||("category"==_this.$route.name?urlStr+="&filter[category_name]="+_this.$route.params.category:"tag"==_this.$route.name&&(urlStr+="&filter[tag]="+_this.$route.params.tag)),_this.isEmpty(_this.$route.query)||(_this.$route.query.term&&(urlStr+="&search="+_this.$route.query.term),isNaN(_this.$route.query.page)||(urlStr+="&page="+_this.$route.query.page)),"/"==_this.$route.path&&(urlStr+="&per_page=3"),axios.get(urlStr).then(function(response){_this.posts=response.data,_this.pagers=_this.buildPager(response.headers),_this.post={},_this.comments=[]}).catch(function(error){console.log(error)})},isEmpty:function(obj){for(var key in obj)if(obj.hasOwnProperty(key))return!1;return!0}}}).$mount("#app");